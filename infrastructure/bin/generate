#!/usr/bin/env bash

set -o errexit
set -o pipefail
set -o nounset

PYTHON="python -Wall"

declare -a STACKS=(
	dns.py
	global.py
	main.py
	storage.py
)

rm -rf ./infrastructure/cloudformation/_generated/*.template
mkdir -p ./infrastructure/cloudformation/_generated

echo
for stack in "${STACKS[@]}"; do
	echo "--- Generating template for ./cloudformation/troposphere/${stack} ..."
	${PYTHON} "./infrastructure/cloudformation/troposphere/${stack}" \
		> "./infrastructure/cloudformation/_generated/${stack}.template"
done
echo
